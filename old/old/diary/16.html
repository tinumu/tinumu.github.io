<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" type="text/css" href="../mainstyle.css">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script type="text/javascript"
src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_CHTML">
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
tex2jax: {
inlineMath: [['$','$'], ['\\(','\\)']],
processEscapes: true
},
CommonHTML: { matchFontHeight: false }
});
</script>

<title>Diary</title>
</head>
<body>
<h1>JOI2006-2007本選4問目 最悪の記者</h1>
<h2>概要</h2>
<p>
<a href="http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=0519">このサイトなどを参考に。(AOJ)</a>
$N$ 個のサッカーチームの総当たりリーグ戦が行われた。<br>
引き分けがなくすべてのチームに異なる順位がついた。 $a$ 位のチームは必ず $b$ 位のチームに勝っている。<br>
勝敗のデータが $M$ 個与えられたとき、あり得る順位表を一つ出力し、他にあり得る順位表がある場合 $1$, ない場合 $0$ を出力せよ。<br>
勝敗のデータは $i, j$ で与えられ、$i$ のチームが $j$ のチームに勝利したことを示す。<br>
</p>
<h2>制約</h2>
<ul>
<li>$1 \leq N \leq 5000$</li>
<li>$1 \leq M \leq 10^5$</li>
<li>$1 \leq i, j \leq N$</li>
</ul>
<h2>解法</h2>
<p>
もし、$a$ が $b$ に勝っていれば、$b$ よりも $a$ のほうが低い順位であることは間違いない。<br>
なんかグラフにするっぽいなあって思ってて、トポロジカル順序にやっていけば低い順位から探っていけるなってなった。<br>
だが、どうやったら2通りうまれるのか、明確なところが分からない。ウーン、断念に近い状態。<br>
本選一緒に行く人が解いていて、色々と話しながら(一緒に書いているコード見ながら)やっていった。<br>
何を思っていたかわからないけど、幅でトポロジカルソート中にキューのサイズが2以上になった瞬間に2通りになることに気付いてACした。<br>
なんで2以上？ってのを考えたい。
</p>

<p>
順位を低い順に並べたいときになぜトポロジカルソートを用いるといいか。<br>
トポロジカルソートは出力先のノードが必ず後ろに来るようになる。これを置き換える。<br>
自分より順位の高いチームが必ず後ろに来るようになるという意味となる。<br>
何で置き換えられたんだろうか?<br>
順位の低い・高いという二つの概念を一般化してみよう。<br>
例えば先頭側・末尾側という名前をとるとする。<br>
トポロジカルソートに最低限必要なノードの情報はそれ自体には無く、比較対象として使う。<br>
エッジに情報を持っている。それが「どちらが先頭側で末尾側であるか」である。<br>
これによってどれを比較しても先頭側となるノードから末尾側のノードまで並べ上げることが出来るというわけである。<br>
まとめると、トポロジカルソートは<b>先頭側か末尾側かが決定できるような"エッジ"を持つグラフについて使うことが出来るテクニック</b>であるといえる。<br>
加えて先頭側の先頭側は先頭側であることも条件の一つだ。<br>
つまり、順位の低い・高いをエッジで表現できる( $i$ は $j$ より順位が低いとみなせる入力があるため)この問題では、<br>
順位を低い順(先頭側から順)にならべていけることができるということがわかるのだ。<br>
トポロジカルソート中にどちらが先頭側か末尾側か明確な区別がないとき勝手に先頭側か末尾側かを決定するフェーズが必ず出てくる。<br>
選ぶということはそこからトポロジカル順序が2通り以上生まれることを意味する。つまり順位パターンが2つ以上生まれることを意味するのだ。<br>
幅優先探索ではキューに溜まってpopする時、選んでいることになる。<br>
キューにpushされるノードは入次数がすでに $0$ となっているもののことを言う。これは他の先頭側のものを取り除いたときに一番先頭側のノードである。<br>
もしこれが $2$ つ出てきたら $2$ つのノードはどちらかが先頭側でなければ末尾側ではないのである。<br>
末尾側だったら入次数は $0$ にならないので矛盾するし、先頭側だったら片方が末尾側であるから矛盾することが分かる。<br>
$3$ つ以上の場合でも結局は選ぶことになるのでやっぱり2つの場合と同じである。<br>
よって、トポロジカルソート中にキューのサイズが2以上になったら2通り以上あることが分かった。
</p>
<h2>ソース</h2>
<script src="https://gist.github.com/tinumu/6da631ed0ba32a29b57dded032b6951c.js"></script>
<h2>感想</h2>
<p>
一緒に考えてくれた友達に感謝を捧げまくりたい。<br>
トポロジカルソートマスターになれそう(小並感)(ソードマスターみたい)
</p>
</body>
</html>
