<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" type="text/css" href="../mainstyle.css">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script type="text/javascript"
src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_CHTML">
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
tex2jax: {
inlineMath: [['$','$'], ['\\(','\\)']],
processEscapes: true
},
CommonHTML: { matchFontHeight: false }
});
</script>

<title>Diary</title>
</head>
<body>
<h1>JOI2007春合宿2-2 Fermat</h1>
<h2>概要</h2>
<p>
素数 $p$ と、自然数 $n \geq 1$ が与えられたとき、<br>
$x^n + y^n \equiv z^n(mod$ $n)$<br>
を満たす、$x, y, z(0 \leq x, y, z \leq p - 1)$ の個数 $m$ を求めよ。
</p>
<h2>制約</h2>
<ul>
<li>$p \le 10000$ ( $p$ は素数)</li>
<li>$1 \leq n \leq 10000$</li>
</ul>
<h2>解法</h2>
<p>
$p$ の剰余をとるということは何らかの $n$ 乗でとり得る値の通りは $p$ 以下になることが分かる。<br>
$0 \leq x, y, z \leq p - 1$ であるため、繰り返し二乗法を使用して $k^n(0 \leq k \leq p - 1)$ の通りを先に作成した。
最初、flag[10005]で $k^n$ があるかというのを見る物を作ったが、<br>
よくよく考えると、cnt[10005]にして $k^n$ が $x, y, z$ において何個あるのかという情報が必要なことが分かった。
$x^n$ と$y^n$ を決めた時、$z^n$ も決まるので、$x^n, y^n$ の値を決め打ちして$i, j$ として cnt[i] * cnt[j] * cnt[(i + j) % p] を加算していって値を求めた。<br>
$z^n$ を決めた時他に決まらなかった組み合わせはすべて式が成り立たないから見なくてもよかったのである。
</p>
<h2>ソース</h2>
<script src="https://gist.github.com/tinumu/c0a283baad3c5360d2d1fdba1bd42d70.js"></script>
<h2>感想</h2>
<p>
結構典型だけど、a + b = cになってるとき、2つ決めれば3つめが分かるみたいなのを覚えていきたい。<br>
あと、まとめられるところはまとめて計算するとオーダーが落ちることがある！！
</p>
</body>
</html>
