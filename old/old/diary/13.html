<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" type="text/css" href="../mainstyle.css">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script type="text/javascript"
src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_CHTML">
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
tex2jax: {
inlineMath: [['$','$'], ['\\(','\\)']],
processEscapes: true
},
CommonHTML: { matchFontHeight: false }
});
</script>

<title>Diary</title>
</head>
<body>
<h1>JOI2011春合宿Day1-1 Banner</h1>
<h2>概要</h2>
<p>
東西方向に走る $H$ 本の道路と南北方向に走る $W$ 本の道路が碁盤上に通っている。<br>
この道路が交わるところを交差点と呼ぶ。北から $a$ 番目、西から $b$ 番目の交差点を $(a, b)$ で表す。<br>
各交差点に柱が $1$ 本立っていて、それには黒、灰、白の $3$ 色がある。これらを数値で $0, 1, 2$ と置く。<br>
$4$ 本の柱が頂点となってそれらが長方形となるように横断幕をかける。必ず $4$ 本の柱にはすべての色が含まれていなければならない。<br>
そのような柱の選び方は何通りあるか。
</p>
<h2>制約</h2>
<ul>
<li>$1 \leq H, W \leq 400$</li>
<li>交差点の値は$0, 1, 2$のいずれかである</li>
</ul>
<h2>解法</h2>
<p>
最初、いろいろ誤読をしていたが、気づいた後の考え方としては、行か列を固定して計算量を減らすのではないのかなと思った。<br>
まず、すべて固定しようとすると、$O(H^2W^2)$ になるのでまあまずい。<br>
そこで まず、行を2つ固定することにした。<br>
列を一つ固定することでできるパターンごとに横に累積和して横軸を動かしつつやる方法が確かに $O(H^2W)$ではあったが、<br>
定数倍6がかかってしまい、詳しく計算するとTLEするんじゃねーのって感じになった。ここで断念。<br>
ということで解法を色々と見てみた。<br>
行を固定すればあとは長方形の列2組を組み合わせるだけでいいため、そこを考える。<br>
組それぞれには出来るパターンが6つしかない。<br>
パターンa, bを組み合わせて条件を満たすような状態になったとき、パターンa である列の数 $\times$ パターンbである列の数だけ柱の選び方があることが分かる。<br>
組み合わせる場合、${}_6C_2 = 15$通りだけ見ればいいだけなので、各パターンの数を調べるのに $O(W)$ を使用するのが最大になり、<br>
全体の計算量は $O(H^2W)$ で、解くことが出来る。
</p>
<h2>ソース</h2>
<script src="https://gist.github.com/tinumu/44c54ad890afcbe94f20888b78d47bcb.js"></script>
<h2>感想</h2>
<p>中身の値を利用して計算したほうが速い場合があるため、そこに気付くかが一番大事である。</p>
<p>家の犬ワンワン鳴きすぎだよ本当に…</p>
</body>
</html>
